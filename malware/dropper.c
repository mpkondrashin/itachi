/***************************************************************
*
* Itachi (c) 2022 by Michael Kondrashin (mkondrashin@gmail.com)
* Copyright under MIT Lincese. Please see LICENSE file for details
*
* dropper.c - write eicar.com to locally
*
***************************************************************/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char unique[] = "XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX";
const char *reicar = "*H+H$!ELIF-TSET-SURIVITNA-DRADNATS-RACIE$}7)CC7)^P(45XZP\\4[PA@%P!O5X";
//const char *eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*";
const char *filename = "eicar.com";
int main() {
    FILE *f = fopen(filename, "w");
    if (f == NULL) {
        perror(filename);
        exit(1);
    }
    for (int i = strlen(reicar)-1; i >=0; i-- ){
        fputc(reicar[i], f);
    }
    return fclose(f);
}